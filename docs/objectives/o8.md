# Broken Tag Generator

**Difficulty**: :fontawesome-solid-star::fontawesome-solid-star::fontawesome-solid-star::fontawesome-solid-star::fontawesome-regular-star:<br/>
**Direct link**: [tag-generator website](https://tag-generator.kringlecastle.com/)<br/>
**Terminal hint**: [Redis Bug Hunt](../hints/h8.md)


## Objective

!!! question "Request"
    Help Noel Boetie fix the [Tag Generator](https://tag-generator.kringlecastle.com/) in the Wrapping Room. What value is in the environment variable GREETZ? Talk to Holly Evergreen in the kitchen for help with this.

??? quote "Noel Boetie"
    Welcome to the Wrapping Room, Santa!

    The tag generator is acting up.

    I feel like the issue has something to do with weird files being uploaded.

    Can you help me figure out what's wrong?
    


## Hints

??? hint "Patience and Timing - Holly Evergreen"
    Remember, the processing happens in the background so you might need to wait a bit after exploiting but before grabbing the output!

??? hint "Source Code Analysis - Holly Evergreen"
    I'm sure there's a vulnerability in the source somewhere... surely Jack wouldn't leave their mark?

??? hint "Endpoint Exploration - Holly Evergreen"
    Is there an endpoint that will print arbitrary files?

??? hint "Content-Type Gotcha - Holly Evergreen"
    If you're having trouble seeing the code, watch out for the Content-Type! Your browser might be trying to help (badly)!

??? hint "Error Page Message Disclosure - Holly Evergreen"
    Can you figure out the path to the script? It's probably on error pages!

??? hint "Download File Mechanism - Holly Evergreen"
    Once you know the path to the file, we need a way to download it!

??? hint "Source Code Retrieval - Holly Evergreen"
    We might be able to find the problem if we can get source code!

??? hint "Redirect to Download - Holly Evergreen"
    If you find a way to execute code blindly, I bet you can redirect to a file then download that file!


## Solution

!!! note "Quick 'n dirty or reverse shell?"
    You can either solve this with minimal effort or you can go for a reverse shell. We'll explore both options! :smile:

!!! done "Answer"
    JackFrostWasHere

!!! quote "Noel Boetie"
    Yay! You found the flaw!
    
    We'll work on fixing it.
