{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Introduction \u2693\ufe0e Hi and welcome to my 2020 SANS Holiday Hack Challenge write-up. This is now the third time I've had the privilege of traveling to the North Pole to attend KringleCon and help out Santa and the elves in solving all sorts of hacking shennanigans. It has really become one of those event I look forward to with a lot of anticipation each year! There's 3 main sections: this page which contains the introduction, answers, and overall narrative. Objectives contains the write-ups for the main objectives for which an answer had to be submitted and Terminal hints has the write-ups for the additional side challenges which provide you with hints to help solve the main objectives. A few additional things worth pointing out are the reverse shell I was able to obtain on the Broken Tag Generator challenge and the large (but definitely incomplete) list of Easter eggs and references I came across (e.g., Garden Party, the story behind all those landscape paintings, the New Jersy Turnpike exit, Jason is back... twice). Finally, I hope you have as much fun reading this write-up as I had writing it! 50-page submission limit New this year is the requirement to keep the total write-up length under 50 pages. While I understand there's a huge number of write-ups that need to be reviewed by the SANS and Counter Hack teams, my primary goal for this write-up is to help others learn and be a resource that remains relevant for a long time. I'll do my best to keep the irrelevant banter down to a minimum but there's no cutting corners when it comes to sharing knowledge and learning! Navigation tip Even with less than 50 pages, there's still quite a bit of information to read through. To make things a little easier, you can use P or , to go to the previous section, N or . to navigate to the next section, and S , F , or / to open up the search dialog. TL;DR if you keep pressing N or . from this point forward, you'll hit all the content in the right order! Answers \u2693\ufe0e 1. Uncover Santa's Gift List - Proxmark 2. Investigate S3 Bucket - North Pole: The Frostiest Place on Earth 3. Point-of-Sale Password Recovery - santapass 4. Operate the Santavator - See this example configuration using the hex nut found in front of the Santavator and the green light bulb found in the Courtyard. 5. Open HID Lock - Use lf hid sim -r 2006e22f13 to unlock the door using Shinny Upatree's badge information. 6. Splunk Challenge - The Lollipop Guild 7. Solve the Sleigh's CAN-D-BUS Problem - 19B Equals 0000000F2057 080 Less 000000000000 8. Broken Tag Generator - JackFrostWasHere 9. ARP Shenanigans - Tanta Kringle 10. Defeat Fingerprint Sensor - besanta 11. Naughty/Nice List with Blockchain Investigation Part 1 - 57066318f32f729d 12. Naughty/Nice List with Blockchain Investigation Part 2 - fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb Map & Directory \u2693\ufe0e No matter how hard I'd try, my graphical skills would never be able to do justice to the amazing ASCII art map that's already provided by the Kringle Kiosk . Without ASCII there'd be no write-up, so it's only appropriate to showcase this artistic gem! Two minor additions to the map are the dark hallway leading to Santa's portrait and the hidden Garden Party area near the courtyard. Jason , located next to the bucket on the scaffolding on the front lawn, was added to the directory as well. Map __ _ -------------- |__)_ _ (_ | NetWars Room | | \\(_)(_)| | | | * | -------------- __ __ __ __ _)|_ _)|_ ------- /__| Tracks __)| |Balcony| 1 2 3 4 5 6 7 ------- ------- ------------- | |Speaker|--| Talks Lobby | -------- |Unprep | | | |Santa's | ------- ------ | |Office | | | -- -- | *| | | ------ | --- | * | __ ------ ------ /||_ |Garden| || |Party | ------ | __ __ -------- -------------------------- /| |_ |_ |Wrapping| | Courtyard | |.__)| | Room | -------------------------- -------- | | | ------ -------- ------ ---- -------- |Dining|--|Kitchen |--|Great | | |--|Workshop| | | -------- | | | | | | | Room |--| * |--| Room | | | | | | | |Entryway| | | | | | | ------ -------- ------ | .. | | | | ---- | * | ---------- -------- |Front Lawn| NOTE: * denotes Santavator ---------- Directory Quick tip You can sort the table data by clicking on the table headers. Name Floor Room Terminal Hint Ribb Bonbowford 1 Dining Room The Elf C0de Noel Boetie 1 Wrapping Room - Ginger Breddie 1 Castle Entry - Minty Candycane 1.5 Workshop Sort-o-Matic Angel Candysalt 1 Great Room - Tangle Coalbox 1 Speaker UNPreparedness Snowball Fight Bushy Evergreen 2 Talks Lobby Speaker UNPrep Holly Evergreen 1 Kitchen Redis Bug Hunt Jason - Front Lawn - Bubble Lightington 1 Courtyard - Jewel Loggins - Front Lawn - Sugarplum Mary 1 Courtyard Linux Primer Pepper Minstix - Front Lawn Unscape Tmux Bow Ninecandle 2 Talks Lobby - Morcel Nougat 2 Speaker UNPreparedness - Wunorse Openslae R NetWars Room CAN-Bus Investigation Sparkle Redberry 1 Castle Entry - Jingle Ringford - NJTP - Piney Sappington 1 Castle Entry - Chimney Scissorsticks 2 Talks Lobby - Fitzy Shortstack 1 Kitchen 33.6kbps Alabaster Snowball R NetWars Room Scapy Prepper Eve Snowshoes 3 Santa's Balcony - Shinny Upatree - Front Lawn Kringle Kiosk Tinsel Upatree 3 Santa's Office - Conclusion \u2693\ufe0e Narrative KringleCon back at the castle, set the stage... But it's under construction like my GeoCities page. Feel I need a passport exploring on this platform - Got half floors with back doors provided that you hack more! Heading toward the light, unexpected what you see next: An alternate reality, the vision that it reflects. Mental buffer's overflowing like a fast food drive-thru trash can. Who and why did someone else impersonate the big man? You're grepping through your brain for the portrait's \"JFS\" \"Jack Frost: Santa,\" he's the villain who had triggered all this mess! Then it hits you like a chimney when you hear what he ain't saying: Pushing hard through land disputes, tryin' to stop all Santa's sleighing. All the rotting, plotting, low conniving streaming from that skull. Holiday Hackers, they're no slackers, returned Jack a big, old null! We already knew from last year's narrative and cliffhanger that Jack Frost was in cahoots with the Tooth Fairy, silently working from the shadows. This year we got to unravel his evil plan and actually stop him! Jack Frost not only tried to prevent the expansion of Santa\u2019s Castle but he also gave Santa a magical portrait so he could become him and destroy the holidays! Santa Thank you for foiling Jack\u2019s foul plot! He sent that magical portrait so he could become me and destroy the holidays! Due to your incredible work, you have set everything right and saved the holiday season! Congratulations on a job well done! Ho Ho Ho! Jack Frost My plan was NEARLY perfect... but I never expected someone with your skills to come around and ruin my plan for ruining the holidays! And now, they\u2019re gonna put me in jail for my deeds.","title":"Welcome"},{"location":"#introduction","text":"Hi and welcome to my 2020 SANS Holiday Hack Challenge write-up. This is now the third time I've had the privilege of traveling to the North Pole to attend KringleCon and help out Santa and the elves in solving all sorts of hacking shennanigans. It has really become one of those event I look forward to with a lot of anticipation each year! There's 3 main sections: this page which contains the introduction, answers, and overall narrative. Objectives contains the write-ups for the main objectives for which an answer had to be submitted and Terminal hints has the write-ups for the additional side challenges which provide you with hints to help solve the main objectives. A few additional things worth pointing out are the reverse shell I was able to obtain on the Broken Tag Generator challenge and the large (but definitely incomplete) list of Easter eggs and references I came across (e.g., Garden Party, the story behind all those landscape paintings, the New Jersy Turnpike exit, Jason is back... twice). Finally, I hope you have as much fun reading this write-up as I had writing it! 50-page submission limit New this year is the requirement to keep the total write-up length under 50 pages. While I understand there's a huge number of write-ups that need to be reviewed by the SANS and Counter Hack teams, my primary goal for this write-up is to help others learn and be a resource that remains relevant for a long time. I'll do my best to keep the irrelevant banter down to a minimum but there's no cutting corners when it comes to sharing knowledge and learning! Navigation tip Even with less than 50 pages, there's still quite a bit of information to read through. To make things a little easier, you can use P or , to go to the previous section, N or . to navigate to the next section, and S , F , or / to open up the search dialog. TL;DR if you keep pressing N or . from this point forward, you'll hit all the content in the right order!","title":"Introduction"},{"location":"#answers","text":"1. Uncover Santa's Gift List - Proxmark 2. Investigate S3 Bucket - North Pole: The Frostiest Place on Earth 3. Point-of-Sale Password Recovery - santapass 4. Operate the Santavator - See this example configuration using the hex nut found in front of the Santavator and the green light bulb found in the Courtyard. 5. Open HID Lock - Use lf hid sim -r 2006e22f13 to unlock the door using Shinny Upatree's badge information. 6. Splunk Challenge - The Lollipop Guild 7. Solve the Sleigh's CAN-D-BUS Problem - 19B Equals 0000000F2057 080 Less 000000000000 8. Broken Tag Generator - JackFrostWasHere 9. ARP Shenanigans - Tanta Kringle 10. Defeat Fingerprint Sensor - besanta 11. Naughty/Nice List with Blockchain Investigation Part 1 - 57066318f32f729d 12. Naughty/Nice List with Blockchain Investigation Part 2 - fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb","title":"Answers"},{"location":"#map-directory","text":"No matter how hard I'd try, my graphical skills would never be able to do justice to the amazing ASCII art map that's already provided by the Kringle Kiosk . Without ASCII there'd be no write-up, so it's only appropriate to showcase this artistic gem! Two minor additions to the map are the dark hallway leading to Santa's portrait and the hidden Garden Party area near the courtyard. Jason , located next to the bucket on the scaffolding on the front lawn, was added to the directory as well. Map __ _ -------------- |__)_ _ (_ | NetWars Room | | \\(_)(_)| | | | * | -------------- __ __ __ __ _)|_ _)|_ ------- /__| Tracks __)| |Balcony| 1 2 3 4 5 6 7 ------- ------- ------------- | |Speaker|--| Talks Lobby | -------- |Unprep | | | |Santa's | ------- ------ | |Office | | | -- -- | *| | | ------ | --- | * | __ ------ ------ /||_ |Garden| || |Party | ------ | __ __ -------- -------------------------- /| |_ |_ |Wrapping| | Courtyard | |.__)| | Room | -------------------------- -------- | | | ------ -------- ------ ---- -------- |Dining|--|Kitchen |--|Great | | |--|Workshop| | | -------- | | | | | | | Room |--| * |--| Room | | | | | | | |Entryway| | | | | | | ------ -------- ------ | .. | | | | ---- | * | ---------- -------- |Front Lawn| NOTE: * denotes Santavator ---------- Directory Quick tip You can sort the table data by clicking on the table headers. Name Floor Room Terminal Hint Ribb Bonbowford 1 Dining Room The Elf C0de Noel Boetie 1 Wrapping Room - Ginger Breddie 1 Castle Entry - Minty Candycane 1.5 Workshop Sort-o-Matic Angel Candysalt 1 Great Room - Tangle Coalbox 1 Speaker UNPreparedness Snowball Fight Bushy Evergreen 2 Talks Lobby Speaker UNPrep Holly Evergreen 1 Kitchen Redis Bug Hunt Jason - Front Lawn - Bubble Lightington 1 Courtyard - Jewel Loggins - Front Lawn - Sugarplum Mary 1 Courtyard Linux Primer Pepper Minstix - Front Lawn Unscape Tmux Bow Ninecandle 2 Talks Lobby - Morcel Nougat 2 Speaker UNPreparedness - Wunorse Openslae R NetWars Room CAN-Bus Investigation Sparkle Redberry 1 Castle Entry - Jingle Ringford - NJTP - Piney Sappington 1 Castle Entry - Chimney Scissorsticks 2 Talks Lobby - Fitzy Shortstack 1 Kitchen 33.6kbps Alabaster Snowball R NetWars Room Scapy Prepper Eve Snowshoes 3 Santa's Balcony - Shinny Upatree - Front Lawn Kringle Kiosk Tinsel Upatree 3 Santa's Office -","title":"Map &amp; Directory"},{"location":"#conclusion","text":"Narrative KringleCon back at the castle, set the stage... But it's under construction like my GeoCities page. Feel I need a passport exploring on this platform - Got half floors with back doors provided that you hack more! Heading toward the light, unexpected what you see next: An alternate reality, the vision that it reflects. Mental buffer's overflowing like a fast food drive-thru trash can. Who and why did someone else impersonate the big man? You're grepping through your brain for the portrait's \"JFS\" \"Jack Frost: Santa,\" he's the villain who had triggered all this mess! Then it hits you like a chimney when you hear what he ain't saying: Pushing hard through land disputes, tryin' to stop all Santa's sleighing. All the rotting, plotting, low conniving streaming from that skull. Holiday Hackers, they're no slackers, returned Jack a big, old null! We already knew from last year's narrative and cliffhanger that Jack Frost was in cahoots with the Tooth Fairy, silently working from the shadows. This year we got to unravel his evil plan and actually stop him! Jack Frost not only tried to prevent the expansion of Santa\u2019s Castle but he also gave Santa a magical portrait so he could become him and destroy the holidays! Santa Thank you for foiling Jack\u2019s foul plot! He sent that magical portrait so he could become me and destroy the holidays! Due to your incredible work, you have set everything right and saved the holiday season! Congratulations on a job well done! Ho Ho Ho! Jack Frost My plan was NEARLY perfect... but I never expected someone with your skills to come around and ruin my plan for ruining the holidays! And now, they\u2019re gonna put me in jail for my deeds.","title":"Conclusion"},{"location":"easter_eggs/","text":"It's amazing how many references and easter eggs you can find once you start looking around for them. Movie references, jokes, nods to popular culture, memes, secret areas, references to past Holiday Hack Challenge, and funny WebSocket response messages. Below are a few of them, in no particular order. Three French Hens \u2693\ufe0e When the title of this year's event was announced on Twitter a pattern emerged. Last year was named KringleCon 2: Turtle Doves , this time it's KringleCon 3: French Hens . The titles appear to be taken from the Twelve Days of Christmas carol. The Twelve Days Of Christmas ... On the second day of Christmas My true love gave to me: Two turtle doves ... On the third day of Christmas My true love gave to me: Three french hens ... On the forth day of Christmas My true love gave to me: Four calling birds ... Being John Malkovich \u2693\ufe0e The idea of going to an in-between floor (i.e., 1.5) and ending up in the body of another person (i.e., Santa) is a direct reference to the movie Being John Malkovich . In the movie, directed by Spike Jonze and written by Charlie Kaufman, a puppeteer discovers a portal on a floor between the 7th and 8th that leads literally into the head of movie star John Malkovich, similar to how we go to a floor between the 1st and 2nd floors and ultimately end up being Santa. New Jersey Turnpike \u2693\ufe0e When the Holiday Hack Challenge website tells you to hop on the New Jersey Turnpike to get to Santa's gondola for your ride to the North Pole , you can take that pretty literally. Taking exit 7A and following Interstate 195 to Shore Points, brings you close to the Counter Hack HQ, better known as Santa's castle. The New Jersey Turnpike also plays a key role in the movie Being John Malkovich . It's where the movie's main character ends up when he's ejected from John Malkovich's mind and body after about 15 minutes. Zat You, Santa Claus? \u2693\ufe0e A reference to Zat You, Santa Claus? by Louis Armstrong . Garden Party \u2693\ufe0e To the North and slightly off to the East of the swag booth you can pass through the hedge to enter a secret area. The NPC behind the booth is named npc-evanbooth , Counter Hack's resident builder, architect, developer, and challenge designer . The clip that's playing is the original video for what later became the Dimitri Finds Out meme . You can't go there as Santa though. Santa Discounts \u2693\ufe0e When you talk to the SANS.edu and RSA Conference booth NPCs as Santa, they'll give you a discount code. Also, the NPCs manning the conference booths all have actual names. Can we get a round of applause for Brian, Peaches, Geek, Jeff, and Kulj, please? Geek - SANS.edu booth Hi Santa! Because you give so much to the world, we\u2019re giving you a code to waive your application fee to SANS.edu, the best college in cybersecurity. Use the code SantaGoesToCollege when you apply. Thanks for hacking for good! Kulj - RSA Conference booth Congratulations, Santa! You\u2019ve unlocked $20 off a Full Summit Pass for the new RSAC 365 Virtual Summit. Use code 10SANSF59 . Click to learn more . Jason \u2693\ufe0e Just like last year's event, Jason can be found in 2 different locations. First as the nail next to the bucket image named jason 2.png on the scaffolding in front of the castle and again as an ASCII art image of a plant located at /opt/plant.txt . The ASCII image can also be found when entering plant as a menu option in the Kringle Kiosk Terminal Hint challenge. Hi, my name is Jason the Plant! ( U \\| ) __|/ \\ / \\__/ ejm96 Jason himself actually tweeted a hint for this Easter Egg on December 25, 2020. Nail Job Hunting? Feeling Stuck? Join me for an interactive job hunting livestream! Any industry. Any type of job. No vendor pitches. Not selling anything. Just helping. https://www.twitch.tv/banjocrashland Portrait Painting \u2693\ufe0e The portrait features Ed Skoudis as Santa Claus and was painted by Ed's artist daughter Jessica Skoudis (who is also mentioned in the final credits). The initials on the portrait not only refer to Jack Frost: Santa , as per the narrative, but are in fact Jessica's initials. The items on the desk are references to past Holiday Hack Challenge events . # Item Holiday Hack Challenge 1 Challenge coin First introduced as an award in HHC 2019 2 Tardis Seen on the dorm wall in HHC 2019 3 Cranberry Pi First appeared in HHC 2018 4 Gnome legs Also created by Jessica Skoudis and featured in HHC 2015 5 Enigma machine Seen in an image for HHC 2012 Painting Peephole Trope \u2693\ufe0e Someone peering through the eyes of a painting is a common TV trope and is used in a lot of movies and TV series . The Scooby-Doo animated series used it extensively , for example. Scooby-Doo - TV Tropes It was common for Scooby-Doo to feature a scene of the characters moving past a portrait with moving eyes. A series of Cartoon Network promos for the show titled Scooby-Doo: Behind the Scenes had the characters lampshading the trope in the final promo \"Those Meddling Kids, Together Again\" and Velma jokingly asking why weren't there any haunted houses with landscape paintings. Landscape paintings? Perfect segue into the next easter egg! Castle Artwork \u2693\ufe0e All the artwork spread across Santa's castle is cut from a single image. If you download all the textures from https://2020.kringlecon.com/textures/art/f$i.png , with $i ranging between 1 and 39, you can recreate a Jack Frost painting by Andrew Theophilopoulos . 1 2 3 4 5 6 #!/usr/bin/env bash for i in { 1 ..39 } do curl -s -O https://2020.kringlecon.com/textures/art/f $i .png done Looks like Jack Frost replaced all the paintings with artwork of himself! Proxmark Email \u2693\ufe0e In the Wrapping Room there's an email message hanging on the left wall from Iceman , addressed to Chris Elgee. Proxmark email To: Chris Elgee Re: Proxmark in Holiday Hack Challenge Hey Chris! Proxmark3 is a open name, belonging to the community, no trademark as I know of. The copyright could arguably belong to Jonathan Westhus when he created the first versions some 14 years ago. He has never ex- pressed any claims for the name. So feel free to add it in your challenge :) /Iceman Black Badge \u2693\ufe0e Santa has a black conference badge which is a nod to the DEF CON Black Badge . DEF CON Black Badge The DEF CON Black Badge is a powerful talisman, awarded only to those who have emerged unbeaten from the crucible of elite DEF CON competition. Which competitions? The answer varies from year to year. This is in the nature of the talisman. Those chosen by the Badge enter DEF CON free of charge for the duration of their natural life. Wilhelm Scream \u2693\ufe0e In the 33.6kbps Terminal challenge , the SCHHRRHHRTHRTR sound uses the famous Wilhelm Scream . Snowball Fight Error \u2693\ufe0e The error screen when you lose a Snowball Fight game displays a QR code which leads to the CounterHack website and the error code 501_PEBKAC_ERR_4EVA , which translates to Problem Exists Between Keyboard and Chair , Error, and Forever. In other words, user error. Pretty sure that if you contact the support elf and pass them the error code, they'd laugh at you. WebSocket Codes \u2693\ufe0e The WebSocket at wss://2020.kringlecon.com/ws is a lot of fun to mess around with and others have gone above and beyond to write some amazing helper scripts that let you navigate the game without using the web UI. The WS_OHHIMARK and DENNIS_NEDRY WebSocket response codes are references to the movies The Room and Jurassic Park, respectively. WS_OHHIMARK The WS_OHHIMARK response code is a reference to the famous scene from the movie The Room. DENNIS_NEDRY The DENNIS_NEDRY error code is a reference to Jurassic Park . Richard F. Hall \u2693\ufe0e The billboard titled Richard F. Hall - Custom Homes, LLC , located next to the scaffolding in front of Santa's castle, is a reference to an actual company in the Jersey Shore area. Looking at their portfolio, it's pretty clear why Santa would choose them to help with the castle expansion. That's some impressive work! Stay Frosty Catchphrase \u2693\ufe0e Jack Frost isn't the only one who likes to use the Stay frosty catchphrase. It's actually used in a number of movies. The most famous one probably being Aliens where Corporal Hicks , played by Michael Biehn, uses it in a pep talk. Corporal Hicks - Aliens Hey! I know we\u2019re all in strung-out shape but stay frosty and alert. We can\u2019t afford to let one of those bastards in here. Colonel Stars, played by Jim Carrey, also says it in Kickass 2 . Colonel Stars - Kickass 2 Stay frosty team. I used to eat punks like this for breakfast. Release the Snacken \u2693\ufe0e The vending machine's name is a reference to release the Kraken . The kraken is a legendary sea monster of gigantic size and cephalopod-like appearance in Scandinavian folklore. The phrase comes from the 1981 movie The Clash of the Titans (and its 2010 remake) and is known for being a meme as well. The Lollipop Guild \u2693\ufe0e The adversary group that Santa feared would attack KringleCon is a reference to The Wizard of Oz . Naughty/Nice Reports \u2693\ufe0e Dumping the reports from the Naughty/Nice blockchain provides for some hilarious reading. Quite the welcome distraction once you've spent some time on objective 11 and objective 12 . Below are just a few of examples from the 1547 reports. Elf-on-the-shelf #10830630836554719419 Unbelievably, for the second time this year, I saw Shamicka leaving less than a swallow of orange juice in the container and putting it back into the refrigerator. Elf-on-the-shelf #6203725506778794240 For the second time this month, we spotted Morad referring to someone as \"bro\". Elf-on-the-shelf #809598375456514384 We've noticed that Chaquetta seems to be regularly discussing \"The Bachelorette\" as though it was actually something worthwhile. Some reports noted some excellent behavior as well though. Elf-on-the-shelf #8151363711045738907 Happily, for the second time this year, I saw Hadassah not allowing their IOT devices to be accessible from the internet. Elf-on-the-shelf #6864795698547819664 Maury was spotted running a marathon and not bragging about it to anyone twice today. Elf-on-the-shelf #12595432874979467172 Three time now, Banjamin was seen being a vegan, but never making a big deal out of it.","title":"Easter Eggs"},{"location":"easter_eggs/#three-french-hens","text":"When the title of this year's event was announced on Twitter a pattern emerged. Last year was named KringleCon 2: Turtle Doves , this time it's KringleCon 3: French Hens . The titles appear to be taken from the Twelve Days of Christmas carol. The Twelve Days Of Christmas ... On the second day of Christmas My true love gave to me: Two turtle doves ... On the third day of Christmas My true love gave to me: Three french hens ... On the forth day of Christmas My true love gave to me: Four calling birds ...","title":"Three French Hens"},{"location":"easter_eggs/#being-john-malkovich","text":"The idea of going to an in-between floor (i.e., 1.5) and ending up in the body of another person (i.e., Santa) is a direct reference to the movie Being John Malkovich . In the movie, directed by Spike Jonze and written by Charlie Kaufman, a puppeteer discovers a portal on a floor between the 7th and 8th that leads literally into the head of movie star John Malkovich, similar to how we go to a floor between the 1st and 2nd floors and ultimately end up being Santa.","title":"Being John Malkovich"},{"location":"easter_eggs/#new-jersey-turnpike","text":"When the Holiday Hack Challenge website tells you to hop on the New Jersey Turnpike to get to Santa's gondola for your ride to the North Pole , you can take that pretty literally. Taking exit 7A and following Interstate 195 to Shore Points, brings you close to the Counter Hack HQ, better known as Santa's castle. The New Jersey Turnpike also plays a key role in the movie Being John Malkovich . It's where the movie's main character ends up when he's ejected from John Malkovich's mind and body after about 15 minutes.","title":"New Jersey Turnpike"},{"location":"easter_eggs/#zat-you-santa-claus","text":"A reference to Zat You, Santa Claus? by Louis Armstrong .","title":"Zat You, Santa Claus?"},{"location":"easter_eggs/#garden-party","text":"To the North and slightly off to the East of the swag booth you can pass through the hedge to enter a secret area. The NPC behind the booth is named npc-evanbooth , Counter Hack's resident builder, architect, developer, and challenge designer . The clip that's playing is the original video for what later became the Dimitri Finds Out meme . You can't go there as Santa though.","title":"Garden Party"},{"location":"easter_eggs/#santa-discounts","text":"When you talk to the SANS.edu and RSA Conference booth NPCs as Santa, they'll give you a discount code. Also, the NPCs manning the conference booths all have actual names. Can we get a round of applause for Brian, Peaches, Geek, Jeff, and Kulj, please? Geek - SANS.edu booth Hi Santa! Because you give so much to the world, we\u2019re giving you a code to waive your application fee to SANS.edu, the best college in cybersecurity. Use the code SantaGoesToCollege when you apply. Thanks for hacking for good! Kulj - RSA Conference booth Congratulations, Santa! You\u2019ve unlocked $20 off a Full Summit Pass for the new RSAC 365 Virtual Summit. Use code 10SANSF59 . Click to learn more .","title":"Santa Discounts"},{"location":"easter_eggs/#jason","text":"Just like last year's event, Jason can be found in 2 different locations. First as the nail next to the bucket image named jason 2.png on the scaffolding in front of the castle and again as an ASCII art image of a plant located at /opt/plant.txt . The ASCII image can also be found when entering plant as a menu option in the Kringle Kiosk Terminal Hint challenge. Hi, my name is Jason the Plant! ( U \\| ) __|/ \\ / \\__/ ejm96 Jason himself actually tweeted a hint for this Easter Egg on December 25, 2020. Nail Job Hunting? Feeling Stuck? Join me for an interactive job hunting livestream! Any industry. Any type of job. No vendor pitches. Not selling anything. Just helping. https://www.twitch.tv/banjocrashland","title":"Jason"},{"location":"easter_eggs/#portrait-painting","text":"The portrait features Ed Skoudis as Santa Claus and was painted by Ed's artist daughter Jessica Skoudis (who is also mentioned in the final credits). The initials on the portrait not only refer to Jack Frost: Santa , as per the narrative, but are in fact Jessica's initials. The items on the desk are references to past Holiday Hack Challenge events . # Item Holiday Hack Challenge 1 Challenge coin First introduced as an award in HHC 2019 2 Tardis Seen on the dorm wall in HHC 2019 3 Cranberry Pi First appeared in HHC 2018 4 Gnome legs Also created by Jessica Skoudis and featured in HHC 2015 5 Enigma machine Seen in an image for HHC 2012","title":"Portrait Painting"},{"location":"easter_eggs/#painting-peephole-trope","text":"Someone peering through the eyes of a painting is a common TV trope and is used in a lot of movies and TV series . The Scooby-Doo animated series used it extensively , for example. Scooby-Doo - TV Tropes It was common for Scooby-Doo to feature a scene of the characters moving past a portrait with moving eyes. A series of Cartoon Network promos for the show titled Scooby-Doo: Behind the Scenes had the characters lampshading the trope in the final promo \"Those Meddling Kids, Together Again\" and Velma jokingly asking why weren't there any haunted houses with landscape paintings. Landscape paintings? Perfect segue into the next easter egg!","title":"Painting Peephole Trope"},{"location":"easter_eggs/#castle-artwork","text":"All the artwork spread across Santa's castle is cut from a single image. If you download all the textures from https://2020.kringlecon.com/textures/art/f$i.png , with $i ranging between 1 and 39, you can recreate a Jack Frost painting by Andrew Theophilopoulos . 1 2 3 4 5 6 #!/usr/bin/env bash for i in { 1 ..39 } do curl -s -O https://2020.kringlecon.com/textures/art/f $i .png done Looks like Jack Frost replaced all the paintings with artwork of himself!","title":"Castle Artwork"},{"location":"easter_eggs/#proxmark-email","text":"In the Wrapping Room there's an email message hanging on the left wall from Iceman , addressed to Chris Elgee. Proxmark email To: Chris Elgee Re: Proxmark in Holiday Hack Challenge Hey Chris! Proxmark3 is a open name, belonging to the community, no trademark as I know of. The copyright could arguably belong to Jonathan Westhus when he created the first versions some 14 years ago. He has never ex- pressed any claims for the name. So feel free to add it in your challenge :) /Iceman","title":"Proxmark Email"},{"location":"easter_eggs/#black-badge","text":"Santa has a black conference badge which is a nod to the DEF CON Black Badge . DEF CON Black Badge The DEF CON Black Badge is a powerful talisman, awarded only to those who have emerged unbeaten from the crucible of elite DEF CON competition. Which competitions? The answer varies from year to year. This is in the nature of the talisman. Those chosen by the Badge enter DEF CON free of charge for the duration of their natural life.","title":"Black Badge"},{"location":"easter_eggs/#wilhelm-scream","text":"In the 33.6kbps Terminal challenge , the SCHHRRHHRTHRTR sound uses the famous Wilhelm Scream .","title":"Wilhelm Scream"},{"location":"easter_eggs/#snowball-fight-error","text":"The error screen when you lose a Snowball Fight game displays a QR code which leads to the CounterHack website and the error code 501_PEBKAC_ERR_4EVA , which translates to Problem Exists Between Keyboard and Chair , Error, and Forever. In other words, user error. Pretty sure that if you contact the support elf and pass them the error code, they'd laugh at you.","title":"Snowball Fight Error"},{"location":"easter_eggs/#websocket-codes","text":"The WebSocket at wss://2020.kringlecon.com/ws is a lot of fun to mess around with and others have gone above and beyond to write some amazing helper scripts that let you navigate the game without using the web UI. The WS_OHHIMARK and DENNIS_NEDRY WebSocket response codes are references to the movies The Room and Jurassic Park, respectively. WS_OHHIMARK The WS_OHHIMARK response code is a reference to the famous scene from the movie The Room. DENNIS_NEDRY The DENNIS_NEDRY error code is a reference to Jurassic Park .","title":"WebSocket Codes"},{"location":"easter_eggs/#richard-f-hall","text":"The billboard titled Richard F. Hall - Custom Homes, LLC , located next to the scaffolding in front of Santa's castle, is a reference to an actual company in the Jersey Shore area. Looking at their portfolio, it's pretty clear why Santa would choose them to help with the castle expansion. That's some impressive work!","title":"Richard F. Hall"},{"location":"easter_eggs/#stay-frosty-catchphrase","text":"Jack Frost isn't the only one who likes to use the Stay frosty catchphrase. It's actually used in a number of movies. The most famous one probably being Aliens where Corporal Hicks , played by Michael Biehn, uses it in a pep talk. Corporal Hicks - Aliens Hey! I know we\u2019re all in strung-out shape but stay frosty and alert. We can\u2019t afford to let one of those bastards in here. Colonel Stars, played by Jim Carrey, also says it in Kickass 2 . Colonel Stars - Kickass 2 Stay frosty team. I used to eat punks like this for breakfast.","title":"Stay Frosty Catchphrase"},{"location":"easter_eggs/#release-the-snacken","text":"The vending machine's name is a reference to release the Kraken . The kraken is a legendary sea monster of gigantic size and cephalopod-like appearance in Scandinavian folklore. The phrase comes from the 1981 movie The Clash of the Titans (and its 2010 remake) and is known for being a meme as well.","title":"Release the Snacken"},{"location":"easter_eggs/#the-lollipop-guild","text":"The adversary group that Santa feared would attack KringleCon is a reference to The Wizard of Oz .","title":"The Lollipop Guild"},{"location":"easter_eggs/#naughtynice-reports","text":"Dumping the reports from the Naughty/Nice blockchain provides for some hilarious reading. Quite the welcome distraction once you've spent some time on objective 11 and objective 12 . Below are just a few of examples from the 1547 reports. Elf-on-the-shelf #10830630836554719419 Unbelievably, for the second time this year, I saw Shamicka leaving less than a swallow of orange juice in the container and putting it back into the refrigerator. Elf-on-the-shelf #6203725506778794240 For the second time this month, we spotted Morad referring to someone as \"bro\". Elf-on-the-shelf #809598375456514384 We've noticed that Chaquetta seems to be regularly discussing \"The Bachelorette\" as though it was actually something worthwhile. Some reports noted some excellent behavior as well though. Elf-on-the-shelf #8151363711045738907 Happily, for the second time this year, I saw Hadassah not allowing their IOT devices to be accessible from the internet. Elf-on-the-shelf #6864795698547819664 Maury was spotted running a marathon and not bragging about it to anyone twice today. Elf-on-the-shelf #12595432874979467172 Three time now, Banjamin was seen being a vegan, but never making a big deal out of it.","title":"Naughty/Nice Reports"},{"location":"hints/h11/","text":"","title":"Snowball Fight"},{"location":"hints/h2/","text":"","title":"Kringle Kiosk"},{"location":"hints/h3/","text":"","title":"Linux Primer"},{"location":"hints/h4a/","text":"","title":"Unscape Tmux"},{"location":"hints/h4b/","text":"","title":"The Elf C0de"},{"location":"hints/h5a/","text":"","title":"Speaker UNPrep"},{"location":"hints/h5b/","text":"","title":"33.6kbps"},{"location":"hints/h6/","text":"","title":"Sort-o-Matic"},{"location":"hints/h7/","text":"","title":"CAN-Bus Investigation"},{"location":"hints/h8/","text":"","title":"Redis Bug Hunt"},{"location":"hints/h9/","text":"","title":"Scapy Prepper"},{"location":"objectives/o1/","text":"Uncover Santa's Gift List \u2693\ufe0e Difficulty : Direct link : billboard.png Terminal hint : - Objective \u2693\ufe0e Objective There is a photo of Santa's Desk on that billboard with his personal gift list. What gift is Santa planning on getting Josh Wright for the holidays? Talk to Jingle Ringford at the bottom of the mountain for advice. Jingle Ringford Oh, and before you head off up the mountain, you might want to try to figure out what's written on that advertising bilboard. Have you managed to read the gift list at the center? It can be hard when things are twirly. There are tools that can help! It also helps to select the correct twirly area. Hints \u2693\ufe0e Twirl Area - Jingle Ringford Make sure you Lasso the correct twirly area. Image Edit Tool - Jingle Ringford There are tools out there that could help Filter the Distortion that is this Twirl. Solution \u2693\ufe0e Depending on the image edit, some manipulations are reversible. Download and open the billboard image image in the online image editing tool Jingle Ringford recommends. Select the area around the scrambled letter and apply a Twirl filter with a positive angle value using Filter > Distort > Twirl to unscramble the selected image area. Name Gift Ed Two Front Teeth ?an OU Jersey Jeremy Blanket Brian ? Josh Wright Proxmark Clay Darth Vader Suit Tad Holiday Lights Phil Stuffed Pikachu Jerry Trip to North Pole Answer Proxmark Jingle Ringford Great work with that! I'm sure you'll be able to help us with more challenges up at the castle!","title":"Gift List"},{"location":"objectives/o1/#uncover-santas-gift-list","text":"Difficulty : Direct link : billboard.png Terminal hint : -","title":"Uncover Santa's Gift List"},{"location":"objectives/o1/#objective","text":"Objective There is a photo of Santa's Desk on that billboard with his personal gift list. What gift is Santa planning on getting Josh Wright for the holidays? Talk to Jingle Ringford at the bottom of the mountain for advice. Jingle Ringford Oh, and before you head off up the mountain, you might want to try to figure out what's written on that advertising bilboard. Have you managed to read the gift list at the center? It can be hard when things are twirly. There are tools that can help! It also helps to select the correct twirly area.","title":"Objective"},{"location":"objectives/o1/#hints","text":"Twirl Area - Jingle Ringford Make sure you Lasso the correct twirly area. Image Edit Tool - Jingle Ringford There are tools out there that could help Filter the Distortion that is this Twirl.","title":"Hints"},{"location":"objectives/o1/#solution","text":"Depending on the image edit, some manipulations are reversible. Download and open the billboard image image in the online image editing tool Jingle Ringford recommends. Select the area around the scrambled letter and apply a Twirl filter with a positive angle value using Filter > Distort > Twirl to unscramble the selected image area. Name Gift Ed Two Front Teeth ?an OU Jersey Jeremy Blanket Brian ? Josh Wright Proxmark Clay Darth Vader Suit Tad Holiday Lights Phil Stuffed Pikachu Jerry Trip to North Pole Answer Proxmark Jingle Ringford Great work with that! I'm sure you'll be able to help us with more challenges up at the castle!","title":"Solution"},{"location":"objectives/o10/","text":"Defeat Fingerprint Sensor \u2693\ufe0e Difficulty : Direct link : elevator website Terminal hint : The Elf C0de Objective \u2693\ufe0e Objective Bypass the Santavator fingerprint sensor. Enter Santa's office without Santa's fingerprint. Solution \u2693\ufe0e Santavator part deux! This is the continuation of the Operate the Santavator challenge and details how you can find all the required tokens to fix the Santavator (without actually collecting them) and activate Santa Mode to bypass the fingerprint scanner. Solution here... Tinsel Upatree GOSHGOLLY How did you get in here?? I mean, hey, I'm impressed you made it in here, but you've got to leave! Breaking into Santa's office might mean immediate membership on the wrong side of the Naughty/Nice List. Answer GOSHGOLLY","title":"Fingerprint Sensor"},{"location":"objectives/o10/#defeat-fingerprint-sensor","text":"Difficulty : Direct link : elevator website Terminal hint : The Elf C0de","title":"Defeat Fingerprint Sensor"},{"location":"objectives/o10/#objective","text":"Objective Bypass the Santavator fingerprint sensor. Enter Santa's office without Santa's fingerprint.","title":"Objective"},{"location":"objectives/o10/#solution","text":"Santavator part deux! This is the continuation of the Operate the Santavator challenge and details how you can find all the required tokens to fix the Santavator (without actually collecting them) and activate Santa Mode to bypass the fingerprint scanner. Solution here... Tinsel Upatree GOSHGOLLY How did you get in here?? I mean, hey, I'm impressed you made it in here, but you've got to leave! Breaking into Santa's office might mean immediate membership on the wrong side of the Naughty/Nice List. Answer GOSHGOLLY","title":"Solution"},{"location":"objectives/o11/","text":"Naughty/Nice List with Blockchain Investigation Part 1 \u2693\ufe0e Difficulty : Objective \u2693\ufe0e Objective ... Elf name ... Hints \u2693\ufe0e Hint1 ... Hint2 ... Solution \u2693\ufe0e Answer ... Name ...","title":"Naughty/Nice List Pt.1"},{"location":"objectives/o11/#naughtynice-list-with-blockchain-investigation-part-1","text":"Difficulty :","title":"Naughty/Nice List with Blockchain Investigation Part 1"},{"location":"objectives/o11/#objective","text":"Objective ... Elf name ...","title":"Objective"},{"location":"objectives/o11/#hints","text":"Hint1 ... Hint2 ...","title":"Hints"},{"location":"objectives/o11/#solution","text":"Answer ... Name ...","title":"Solution"},{"location":"objectives/o12/","text":"Naughty/Nice List with Blockchain Investigation Part 2 \u2693\ufe0e Difficulty : Objective \u2693\ufe0e Objective ... Elf name ... Hints \u2693\ufe0e Hint1 ... Hint2 ... Solution \u2693\ufe0e Answer ... Name ...","title":"Naughty/Nice List Pt.2"},{"location":"objectives/o12/#naughtynice-list-with-blockchain-investigation-part-2","text":"Difficulty :","title":"Naughty/Nice List with Blockchain Investigation Part 2"},{"location":"objectives/o12/#objective","text":"Objective ... Elf name ...","title":"Objective"},{"location":"objectives/o12/#hints","text":"Hint1 ... Hint2 ...","title":"Hints"},{"location":"objectives/o12/#solution","text":"Answer ... Name ...","title":"Solution"},{"location":"objectives/o2/","text":"Investigate S3 Bucket \u2693\ufe0e Difficulty : Direct link : awsbucket terminal Terminal hint : Kringle Kiosk Objective \u2693\ufe0e Objective When you unwrap the over-wrapped file, what text string is inside the package? Talk to Shinny Upatree in front of the castle for hints on this challenge. Shinny Upatree Say, we've been having an issue with an Amazon S3 bucket. Do you think you could help find Santa's package file? Jeepers, it seems there's always a leaky bucket in the news. You'd think we could find our own files! Digininja has a great guide, if you're new to S3 searching. He even released a tool for the task - what a guy! The package wrapper Santa used is reversible, but it may take you some trying. Good luck, and thanks for pitching in! Hints \u2693\ufe0e Find Santa's Package - Shinny Upatree Find Santa's package file from the cloud storage provider. Check Josh Wright's talk for more tips! Santa's Wrapper3000 - Shinny Upatree Santa's Wrapper3000 is pretty buggy. It uses several compression tools, binary to ASCII conversion, and other tools to wrap packages. Finding S3 Buckets - Shinny Upatree Robin Wood wrote up a guide about finding these open S3 buckets . Leaky AWS S3 Buckets - Shinny Upatree It seems like there's a new story every week about data exposed through unprotected Amazon S3 buckets . Bucket_finder.rb - Shinny Upatree He even wrote a tool to search for unprotected buckets ! Solution \u2693\ufe0e Updated greeting During the event the message displayed when opening the terminal was updated with some additional hints. Hints: Use the file command to identify a file type. You can also examine tool help using the man command. Search all man pages for a string such as a file extension using the apropos command. To see this help again, run cat /etc/motd. First we need to find the S3 bucket that contains Santa's package file. Navigate to the bucket_finder folder which contains a bucket_finder.rb script and a sample wordlist with some sample bucket names. Running bucket_finder.rb wordlist will find some buckets, but none will be publicly accessible. The message that's displayed when you first connect to the terminal conveniently highlights the Wrapper3000 string, so add that to the wordlist file and execute the command bucket_finder.rb wordlist --download . This will not only check for publicly accessible S3 buckets matching the strings specified in the wordlist file, but it'll also download any files it comes across. Be nice! During the event the bucket_finder.rb script was updated to limit the number of entries in the wordlist to 50. HO HO HO The people at AWS are on the nice list this year! You shouldn't use such a long wordlist. Use the hints in the description for this challenge to help choose a small wordlist to find the missing bucket! Run 'cat /etc/motd' to see it again. SANTA Now that the package file has been downloaded to /home/elf/bucket_finder/wrapper3000/package , we can start the process of unpacking it. We first need to determine the file type though. Run file package which will tell you the contents of the file is ASCII text, with very long lines . cat package will show you the contents. /home/elf/bucket_finder/wrapper3000/package UEsDBAoAAAAAAIAwhFEbRT8anwEAAJ8BAAAcABwAcGFja2FnZS50eHQuWi54ei54eGQudGFyLmJ6MlVUCQADoBfKX6AXyl91eAsAAQT2AQAABBQAAA BCWmg5MUFZJlNZ2ktivwABHv+Q3hASgGSn//AvBxDwf/xe0gQAAAgwAVmkYRTKe1PVM9U0ekMg2poAAAGgPUPUGqehhCMSgaBoAD1NNAAAAyEmJpR5 QGg0bSPU/VA0eo9IaHqBkxw2YZK2NUASOegDIzwMXMHBCFACgIEvQ2Jrg8V50tDjh61Pt3Q8CmgpFFunc1Ipui+SqsYB04M/gWKKc0Vs2DXkzeJmik tINqjo3JjKAA4dLgLtPN15oADLe80tnfLGXhIWaJMiEeSX992uxodRJ6EAzIFzqSbWtnNqCTEDML9AK7HHSzyyBYKwCFBVJh17T636a6YgyjX0eE0I sCbjcBkRPgkKz6q0okb1sWicMaky2Mgsqw2nUm5ayPHUeIktnBIvkiUWxYEiRs5nFOM8MTk8SitV7lcxOKst2QedSxZ851ceDQexsLsJ3C89Z/gQ6X n6KBKqFsKyTkaqO+1FgmImtHKoJkMctd2B9JkcwvMr+hWIEcIQjAZGhSKYNPxHJFqJ3t32Vjgn/OGdQJiIHv4u5IpwoSG0lsV+UEsBAh4DCgAAAAAA gDCEURtFPxqfAQAAnwEAABwAGAAAAAAAAAAAAKSBAAAAAHBhY2thZ2UudHh0LloueHoueHhkLnRhci5iejJVVAUAA6AXyl91eAsAAQT2AQAABBQAAA BQSwUGAAAAAAEAAQBiAAAA9QEAAAAA Looks like we're dealing with BASE64 -encoded data which gives us our starting point. Since we can't be sure what the output of the decoded data will be, we will redirect the output to a file instead of the console using cat package | base64 -d > package2 . From this point forward we repeat the process of identifying the file format and unpacking. # Input file File type Unpack command 1 package BASE64 cat package | base64 -d > package2 2 package2 ZIP archive unzip package2 3 package.txt.Z.xz.xxd.tar.bz2 bzip2 archive bunzip2 package.txt.Z.xz.xxd.tar.bz2 4 package.txt.Z.xz.xxd.tar tar archive tar xf package.txt.Z.xz.xxd.tar 5 package.txt.Z.xz.xxd Hex dump xxd -r package.txt.Z.xz.xxd > package.txt.Z.xz 6 package.txt.Z.xz xz archive xz -d package.txt.Z.xz 7 package.txt.Z compress'd data uncompress package.txt.Z Finally, after 7 steps, cat package.txt gives us the answer. Answer North Pole: The Frostiest Place on Earth","title":"S3 Bucket"},{"location":"objectives/o2/#investigate-s3-bucket","text":"Difficulty : Direct link : awsbucket terminal Terminal hint : Kringle Kiosk","title":"Investigate S3 Bucket"},{"location":"objectives/o2/#objective","text":"Objective When you unwrap the over-wrapped file, what text string is inside the package? Talk to Shinny Upatree in front of the castle for hints on this challenge. Shinny Upatree Say, we've been having an issue with an Amazon S3 bucket. Do you think you could help find Santa's package file? Jeepers, it seems there's always a leaky bucket in the news. You'd think we could find our own files! Digininja has a great guide, if you're new to S3 searching. He even released a tool for the task - what a guy! The package wrapper Santa used is reversible, but it may take you some trying. Good luck, and thanks for pitching in!","title":"Objective"},{"location":"objectives/o2/#hints","text":"Find Santa's Package - Shinny Upatree Find Santa's package file from the cloud storage provider. Check Josh Wright's talk for more tips! Santa's Wrapper3000 - Shinny Upatree Santa's Wrapper3000 is pretty buggy. It uses several compression tools, binary to ASCII conversion, and other tools to wrap packages. Finding S3 Buckets - Shinny Upatree Robin Wood wrote up a guide about finding these open S3 buckets . Leaky AWS S3 Buckets - Shinny Upatree It seems like there's a new story every week about data exposed through unprotected Amazon S3 buckets . Bucket_finder.rb - Shinny Upatree He even wrote a tool to search for unprotected buckets !","title":"Hints"},{"location":"objectives/o2/#solution","text":"Updated greeting During the event the message displayed when opening the terminal was updated with some additional hints. Hints: Use the file command to identify a file type. You can also examine tool help using the man command. Search all man pages for a string such as a file extension using the apropos command. To see this help again, run cat /etc/motd. First we need to find the S3 bucket that contains Santa's package file. Navigate to the bucket_finder folder which contains a bucket_finder.rb script and a sample wordlist with some sample bucket names. Running bucket_finder.rb wordlist will find some buckets, but none will be publicly accessible. The message that's displayed when you first connect to the terminal conveniently highlights the Wrapper3000 string, so add that to the wordlist file and execute the command bucket_finder.rb wordlist --download . This will not only check for publicly accessible S3 buckets matching the strings specified in the wordlist file, but it'll also download any files it comes across. Be nice! During the event the bucket_finder.rb script was updated to limit the number of entries in the wordlist to 50. HO HO HO The people at AWS are on the nice list this year! You shouldn't use such a long wordlist. Use the hints in the description for this challenge to help choose a small wordlist to find the missing bucket! Run 'cat /etc/motd' to see it again. SANTA Now that the package file has been downloaded to /home/elf/bucket_finder/wrapper3000/package , we can start the process of unpacking it. We first need to determine the file type though. Run file package which will tell you the contents of the file is ASCII text, with very long lines . cat package will show you the contents. /home/elf/bucket_finder/wrapper3000/package UEsDBAoAAAAAAIAwhFEbRT8anwEAAJ8BAAAcABwAcGFja2FnZS50eHQuWi54ei54eGQudGFyLmJ6MlVUCQADoBfKX6AXyl91eAsAAQT2AQAABBQAAA BCWmg5MUFZJlNZ2ktivwABHv+Q3hASgGSn//AvBxDwf/xe0gQAAAgwAVmkYRTKe1PVM9U0ekMg2poAAAGgPUPUGqehhCMSgaBoAD1NNAAAAyEmJpR5 QGg0bSPU/VA0eo9IaHqBkxw2YZK2NUASOegDIzwMXMHBCFACgIEvQ2Jrg8V50tDjh61Pt3Q8CmgpFFunc1Ipui+SqsYB04M/gWKKc0Vs2DXkzeJmik tINqjo3JjKAA4dLgLtPN15oADLe80tnfLGXhIWaJMiEeSX992uxodRJ6EAzIFzqSbWtnNqCTEDML9AK7HHSzyyBYKwCFBVJh17T636a6YgyjX0eE0I sCbjcBkRPgkKz6q0okb1sWicMaky2Mgsqw2nUm5ayPHUeIktnBIvkiUWxYEiRs5nFOM8MTk8SitV7lcxOKst2QedSxZ851ceDQexsLsJ3C89Z/gQ6X n6KBKqFsKyTkaqO+1FgmImtHKoJkMctd2B9JkcwvMr+hWIEcIQjAZGhSKYNPxHJFqJ3t32Vjgn/OGdQJiIHv4u5IpwoSG0lsV+UEsBAh4DCgAAAAAA gDCEURtFPxqfAQAAnwEAABwAGAAAAAAAAAAAAKSBAAAAAHBhY2thZ2UudHh0LloueHoueHhkLnRhci5iejJVVAUAA6AXyl91eAsAAQT2AQAABBQAAA BQSwUGAAAAAAEAAQBiAAAA9QEAAAAA Looks like we're dealing with BASE64 -encoded data which gives us our starting point. Since we can't be sure what the output of the decoded data will be, we will redirect the output to a file instead of the console using cat package | base64 -d > package2 . From this point forward we repeat the process of identifying the file format and unpacking. # Input file File type Unpack command 1 package BASE64 cat package | base64 -d > package2 2 package2 ZIP archive unzip package2 3 package.txt.Z.xz.xxd.tar.bz2 bzip2 archive bunzip2 package.txt.Z.xz.xxd.tar.bz2 4 package.txt.Z.xz.xxd.tar tar archive tar xf package.txt.Z.xz.xxd.tar 5 package.txt.Z.xz.xxd Hex dump xxd -r package.txt.Z.xz.xxd > package.txt.Z.xz 6 package.txt.Z.xz xz archive xz -d package.txt.Z.xz 7 package.txt.Z compress'd data uncompress package.txt.Z Finally, after 7 steps, cat package.txt gives us the answer. Answer North Pole: The Frostiest Place on Earth","title":"Solution"},{"location":"objectives/o3/","text":"Point-of-Sale Password Recovery \u2693\ufe0e Difficulty : Direct link : santashop website Terminal hint : Linux Primer Objective \u2693\ufe0e Objective Help Sugarplum Mary in the Courtyard find the supervisor password for the point-of-sale terminal. What's the password? Sugarplum Mary Hey, wouldja' mind helping me get into my point-of-sale terminal? It's down, and we kinda' need it running. Problem is: it is asking for a password. I never set one! Can you help me figure out what it is so I can get set up? Shinny says this might be an Electron application. Hints \u2693\ufe0e Electron ASAR Extraction - Sugarplum Mary There are tools and guides explaining how to extract ASAR from Electron apps. Electron Applications - Sugarplum Mary *It's possible to extract the source code from an Electron app. Solution \u2693\ufe0e Download the santa-shop.exe binary using the link provided on the santa-shop website. The file command tells us it's a Windows executable (thanks Captain Obvious) and a Nullsoft Installer self-extracting archive , which means we can extract the contents using pretty much any capable archive manager. 7-Zip on Windows, Engrampa on Kali Linux, and The Unarchiver on macOS all work. Inside the binary you'll find a 7-zip archive named app-64.7z . Extract that as well. The app.assar archive file is what we're looking for. While the hints provided by Sugarplum Mary point to a tool and a guide on how to extract these types of archives, we can skip all of that. All we really need is grep -a pass app.asar to search for lines containing the string pass . Asar file format Asar is a simple extensive archive format, it works like tar that concatenates all files together without compression, while having random access support. Concatenating plaintext and binary files together doesn't modify the data. In other words, because no compression is being applied, any plaintext information that goes into the Asar archive remains plaintext and will be searchable. The -a parameter forces grep to treat the whole file as ASCII text and print any matching lines to the command line. Answer santapass","title":"Password Recovery"},{"location":"objectives/o3/#point-of-sale-password-recovery","text":"Difficulty : Direct link : santashop website Terminal hint : Linux Primer","title":"Point-of-Sale Password Recovery"},{"location":"objectives/o3/#objective","text":"Objective Help Sugarplum Mary in the Courtyard find the supervisor password for the point-of-sale terminal. What's the password? Sugarplum Mary Hey, wouldja' mind helping me get into my point-of-sale terminal? It's down, and we kinda' need it running. Problem is: it is asking for a password. I never set one! Can you help me figure out what it is so I can get set up? Shinny says this might be an Electron application.","title":"Objective"},{"location":"objectives/o3/#hints","text":"Electron ASAR Extraction - Sugarplum Mary There are tools and guides explaining how to extract ASAR from Electron apps. Electron Applications - Sugarplum Mary *It's possible to extract the source code from an Electron app.","title":"Hints"},{"location":"objectives/o3/#solution","text":"Download the santa-shop.exe binary using the link provided on the santa-shop website. The file command tells us it's a Windows executable (thanks Captain Obvious) and a Nullsoft Installer self-extracting archive , which means we can extract the contents using pretty much any capable archive manager. 7-Zip on Windows, Engrampa on Kali Linux, and The Unarchiver on macOS all work. Inside the binary you'll find a 7-zip archive named app-64.7z . Extract that as well. The app.assar archive file is what we're looking for. While the hints provided by Sugarplum Mary point to a tool and a guide on how to extract these types of archives, we can skip all of that. All we really need is grep -a pass app.asar to search for lines containing the string pass . Asar file format Asar is a simple extensive archive format, it works like tar that concatenates all files together without compression, while having random access support. Concatenating plaintext and binary files together doesn't modify the data. In other words, because no compression is being applied, any plaintext information that goes into the Asar archive remains plaintext and will be searchable. The -a parameter forces grep to treat the whole file as ASCII text and print any matching lines to the command line. Answer santapass","title":"Solution"},{"location":"objectives/o4/","text":"Operate the Santavator \u2693\ufe0e Difficulty : Direct link : elevator website Terminal hint : Unscape Tmux and The Elf C0de Objective \u2693\ufe0e Objective Talk to Pepper Minstix in the entryway to get some hints about the Santavator. Sparkle Redberry Hey hey, Sparkle Redberry here! The Santavator is on the fritz. Something with the wiring is grinchy, but maybe you can rig something up? Here's the key! Good luck! With that key, you can look under the panel and see the Super Santavator Sparkle Stream (S4). To get to different floors, you'll need to power the various colored receivers. Hints \u2693\ufe0e Santavator Operations - Pepper Minstix It's really more art than science. The goal is to put the right colored light into the receivers on the left and top of the panel. Santavator Bypass - Ribb Bonbowford There may be a way to bypass the Santavator S4 game with the browser console... Solution \u2693\ufe0e Sparkle Redberry gives you a key to open up the Santavator panel which will reveal the Super Santavator Sparkle Stream (S4) and the yellow, red, and green receivers. There's 2 main ways to solve this challenge,. Either find items and arrange them to color and direct the stream towards the receivers. Alternatively, you can use the app.js JavaScript code to bypass the Santavator. This write-up focuses on the most basic solution to complete the challenge by using 2 items to activate a single floor. Start by talking to Sparkle Redberry who will hand you a key to open the Santavator panel. You'll find a hex nut in front of the Santavator and a green light bulb in the top left corner of the Courtyard. Open the Santavator panel by clicking on the key and use the hex nut and green light bulb as shown in the image below. Activating the green receiver will get you to the second floor where the talks are held. You can now find additional items like the red light bulb in the top right corner of the Talks Lobby. Since the hex nut already splits the stream towards the red and green receivers, adding the red light bulb in front of the red receiver will get you access to the Workshop and Roof. Below is an overview of where the different items are located. Item Floor Room Candycane 1 In front of the castle door on the Front Lawn Hex nut 1 In front of the Santavator in the Entryway Hex nut 1 Behind the table in the Dining Room (hidden from view) Santavator key 1 Received from Sparkle Redberry Green light bulb 1 Top left corner of the Courtyard Red light bulb 2 Top right corner of the Talks Lobby Yellow light bulb R Top left corner of the Netwars Room Large marble 1.5 In the Workshop Small marble R Bottom right corner of the Netwars Room (hidden from view) Proxmark 1.5 Wrapping Room Rubber ball 1.5 Wrapping Room Elevator 1.5 button 2 Speaker UNPreparedness Room Portals 2 Dropped by Release the Snacken! Answer Use the hex nut found in front of the Santavator and the green light bulb found in the Courtyard to power the green receiver. Bypassing the Santavator Another way to solve this challenge and get to the other floors, except for Santa's office which requires Santa Mode , is by analysing app.js . The Santavator works by calculating how much colored stream particles are received by each of the receivers. Once the proper amount of each stream color has been collected (line 3), the JavaScript code will change the value of the associated color LED in the powered array to true (line 7) and turn on the LED by adding the on CSS class to the LED HTML element (line 6). Vice versa, when the stream levels drop too low the value in the powered array changes back to false (line 7) and the LED is turned off by removing the on CSS class (line 6). All this is handled by the renderTraps() function. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 const renderTraps = () => { TRAPS . forEach (( points , index ) => { const fillLevel = pl . Math . clamp ( PARTICLE_COUNTS [ index ]. length / trapTargetCounts [ index ], 0 , 1 ); const steppa = Math . floor ( fillLevel / ( 1 / wireSteps [ index ])); wireElements [ index ]. style . backgroundPosition = `0 ${ - wireElements [ index ]. clientHeight * steppa } px` ; ledElements [ index ]. classList [ fillLevel === 1 ? 'add' : 'remove' ]( 'on' ); powered [ index ] = fillLevel === 1 ; }); btn1 . classList [ powered [ 2 ] ? 'add' : 'remove' ]( 'powered' ); btn3 . classList [ powered [ 2 ] ? 'add' : 'remove' ]( 'powered' ); btn2 . classList [ powered [ 2 ] && powered [ 0 ] && hasToken ( 'workshop-button' ) ? 'add' : 'remove' ]( 'powered' ); btnr . classList [ powered [ 2 ] && powered [ 0 ] ? 'add' : 'remove' ]( 'powered' ); btn4 . classList [ powered [ 2 ] && powered [ 1 ] && powered [ 0 ] ? 'add' : 'remove' ]( 'powered' ); }; Based on which combination of LEDs are turned on at any given time, the associated buttons will be powered on as well. This is handled by the remainder of the renderTraps() function which uses the state of the powered array to add a powered CSS class to the proper button elements (lines 10-16). Manually adding the powered CSS class to each of the panel buttons doesn't work because the renderTraps() function is continuously called as the scene is being rendered by the render() function and will remove the powered class from the buttons whenever the proper conditions aren't met anymore. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 function render ( newtime ) { if ( stop ) { return ; } requestAnimationFrame ( render ); now = newtime ; elapsed = now - then ; if ( elapsed > fpsInterval ) { then = now - ( elapsed % fpsInterval ); ... SNIP ... renderTraps (); } } Luckily for us, the render() function provides a way to skip calling renderTraps() altogether. Before doing anything else the function checks the value of a stop variable (lines 2-4). If stop is true , we exit from the function and renderTraps() isn't called at all (line 13), thus freezing the stream and preventing any manual changes we make to HTML elements from being reverted. To get to level 1.5 we also need to add the button itself to the panel. The way app.js handles this is by checking if the challenge URL contains a workshop-button value as part of the tokens GET request parameter. If that's the case a found CSS class will be added to the image identified by the f15btn CSS class (line 4), which adds the button to the panel. 1 2 3 4 5 const btn15img = document . querySelector ( 'img.f15btn' ); if ( hasToken ( 'workshop-button' )) { btn15img . classList . add ( 'found' ); } We can now bypass the Super Santavator Sparkle Stream by taking the following actions: Open the web browser's developer tools Open the panel to expose the circuitry Enter stop = true in the JavaScript console to freeze the stream Close the panel again Add a found CSS class to the f15btn image Add a powered CSS class to each of the button elements","title":"Santavator"},{"location":"objectives/o4/#operate-the-santavator","text":"Difficulty : Direct link : elevator website Terminal hint : Unscape Tmux and The Elf C0de","title":"Operate the Santavator"},{"location":"objectives/o4/#objective","text":"Objective Talk to Pepper Minstix in the entryway to get some hints about the Santavator. Sparkle Redberry Hey hey, Sparkle Redberry here! The Santavator is on the fritz. Something with the wiring is grinchy, but maybe you can rig something up? Here's the key! Good luck! With that key, you can look under the panel and see the Super Santavator Sparkle Stream (S4). To get to different floors, you'll need to power the various colored receivers.","title":"Objective"},{"location":"objectives/o4/#hints","text":"Santavator Operations - Pepper Minstix It's really more art than science. The goal is to put the right colored light into the receivers on the left and top of the panel. Santavator Bypass - Ribb Bonbowford There may be a way to bypass the Santavator S4 game with the browser console...","title":"Hints"},{"location":"objectives/o4/#solution","text":"Sparkle Redberry gives you a key to open up the Santavator panel which will reveal the Super Santavator Sparkle Stream (S4) and the yellow, red, and green receivers. There's 2 main ways to solve this challenge,. Either find items and arrange them to color and direct the stream towards the receivers. Alternatively, you can use the app.js JavaScript code to bypass the Santavator. This write-up focuses on the most basic solution to complete the challenge by using 2 items to activate a single floor. Start by talking to Sparkle Redberry who will hand you a key to open the Santavator panel. You'll find a hex nut in front of the Santavator and a green light bulb in the top left corner of the Courtyard. Open the Santavator panel by clicking on the key and use the hex nut and green light bulb as shown in the image below. Activating the green receiver will get you to the second floor where the talks are held. You can now find additional items like the red light bulb in the top right corner of the Talks Lobby. Since the hex nut already splits the stream towards the red and green receivers, adding the red light bulb in front of the red receiver will get you access to the Workshop and Roof. Below is an overview of where the different items are located. Item Floor Room Candycane 1 In front of the castle door on the Front Lawn Hex nut 1 In front of the Santavator in the Entryway Hex nut 1 Behind the table in the Dining Room (hidden from view) Santavator key 1 Received from Sparkle Redberry Green light bulb 1 Top left corner of the Courtyard Red light bulb 2 Top right corner of the Talks Lobby Yellow light bulb R Top left corner of the Netwars Room Large marble 1.5 In the Workshop Small marble R Bottom right corner of the Netwars Room (hidden from view) Proxmark 1.5 Wrapping Room Rubber ball 1.5 Wrapping Room Elevator 1.5 button 2 Speaker UNPreparedness Room Portals 2 Dropped by Release the Snacken! Answer Use the hex nut found in front of the Santavator and the green light bulb found in the Courtyard to power the green receiver. Bypassing the Santavator Another way to solve this challenge and get to the other floors, except for Santa's office which requires Santa Mode , is by analysing app.js . The Santavator works by calculating how much colored stream particles are received by each of the receivers. Once the proper amount of each stream color has been collected (line 3), the JavaScript code will change the value of the associated color LED in the powered array to true (line 7) and turn on the LED by adding the on CSS class to the LED HTML element (line 6). Vice versa, when the stream levels drop too low the value in the powered array changes back to false (line 7) and the LED is turned off by removing the on CSS class (line 6). All this is handled by the renderTraps() function. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 const renderTraps = () => { TRAPS . forEach (( points , index ) => { const fillLevel = pl . Math . clamp ( PARTICLE_COUNTS [ index ]. length / trapTargetCounts [ index ], 0 , 1 ); const steppa = Math . floor ( fillLevel / ( 1 / wireSteps [ index ])); wireElements [ index ]. style . backgroundPosition = `0 ${ - wireElements [ index ]. clientHeight * steppa } px` ; ledElements [ index ]. classList [ fillLevel === 1 ? 'add' : 'remove' ]( 'on' ); powered [ index ] = fillLevel === 1 ; }); btn1 . classList [ powered [ 2 ] ? 'add' : 'remove' ]( 'powered' ); btn3 . classList [ powered [ 2 ] ? 'add' : 'remove' ]( 'powered' ); btn2 . classList [ powered [ 2 ] && powered [ 0 ] && hasToken ( 'workshop-button' ) ? 'add' : 'remove' ]( 'powered' ); btnr . classList [ powered [ 2 ] && powered [ 0 ] ? 'add' : 'remove' ]( 'powered' ); btn4 . classList [ powered [ 2 ] && powered [ 1 ] && powered [ 0 ] ? 'add' : 'remove' ]( 'powered' ); }; Based on which combination of LEDs are turned on at any given time, the associated buttons will be powered on as well. This is handled by the remainder of the renderTraps() function which uses the state of the powered array to add a powered CSS class to the proper button elements (lines 10-16). Manually adding the powered CSS class to each of the panel buttons doesn't work because the renderTraps() function is continuously called as the scene is being rendered by the render() function and will remove the powered class from the buttons whenever the proper conditions aren't met anymore. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 function render ( newtime ) { if ( stop ) { return ; } requestAnimationFrame ( render ); now = newtime ; elapsed = now - then ; if ( elapsed > fpsInterval ) { then = now - ( elapsed % fpsInterval ); ... SNIP ... renderTraps (); } } Luckily for us, the render() function provides a way to skip calling renderTraps() altogether. Before doing anything else the function checks the value of a stop variable (lines 2-4). If stop is true , we exit from the function and renderTraps() isn't called at all (line 13), thus freezing the stream and preventing any manual changes we make to HTML elements from being reverted. To get to level 1.5 we also need to add the button itself to the panel. The way app.js handles this is by checking if the challenge URL contains a workshop-button value as part of the tokens GET request parameter. If that's the case a found CSS class will be added to the image identified by the f15btn CSS class (line 4), which adds the button to the panel. 1 2 3 4 5 const btn15img = document . querySelector ( 'img.f15btn' ); if ( hasToken ( 'workshop-button' )) { btn15img . classList . add ( 'found' ); } We can now bypass the Super Santavator Sparkle Stream by taking the following actions: Open the web browser's developer tools Open the panel to expose the circuitry Enter stop = true in the JavaScript console to freeze the stream Close the panel again Add a found CSS class to the f15btn image Add a powered CSS class to each of the button elements","title":"Solution"},{"location":"objectives/o5/","text":"Open HID Lock \u2693\ufe0e Difficulty : Direct link : proxmark terminal Terminal hint : Speaker UNPrep and 33.6kbps Objective \u2693\ufe0e Objective Open the HID lock in the Workshop. Talk to Bushy Evergreen near the talk tracks for hints on this challenge. You may also visit Fitzy Shortstack in the kitchen for tips. Bushy Evergreen Some people scan other people's badges and try those codes at locked doors. Other people scan one or two and just try to vary room numbers. Do whatever works best for you! Fitzy Shortstack You know, Santa really seems to trust Shinny Upatree... Hints \u2693\ufe0e Reading Badges with Proxmark - Bushy Evergreen You can use a Proxmark to capture the facility code and ID value of HID ProxCard badge by running lf hid read when you are close enough to someone with a badge. Impersonating Badges with Proxmark - Bushy Evergreen You can also use a Proxmark to impersonate a badge to unlock a door, if the badge you impersonate has access. `lf hid sim -r 2006...... What's a Proxmark? - Bushy Evergreen The Proxmark is a multi-function RFID device, capable of capturing and replaying RFID events. Short List of Essential Proxmark Commands - Bushy Evergreen There's a short list of essential Proxmark commands also available. Proxmark Talk - Bushy Evergreen Larry Pesce knows a thing or two about HID attacks . He's the author of a course on wireless hacking! Solution \u2693\ufe0e To solve this challenge we need to find a Proxmark device, roam around Santa's castle to scan NPC badges, and use the collected information to open the HID lock in the workshop. The Proxmark device can be found next to the table in the Wrapping Room and after picking it up you'll be able to access the Proxmark CLI via the item list on your conference badge. As per Bushy Evergreen's hint we can either go around scanning all the NPC badges or we can scan just a few and then fill in the blanks. As Larry Pesce mentions in his HID attacks HID cards are often sold with sequential ID numbers. So all we really need is just enough information to determine that sequence. To scan a badge, stand next to an NPC, open the Proxmark CLI and type lf search or lf hid read . If the NPC has a badge these commands will return the HID card information such as the facility code (FC), and the card ID. Walking around the castle we can compile the following list of badge IDs. NPC name Wiegand Facility code ID Sparkle Redberry 2006e22f0d 113 6022 Shinny Upatree 2006e22f13 113 6025 Holly Evergreen 2006e22f10 113 6024 Noel Boetie (old) 2006e22f08 113 6020 Noel Boetie (new) 2006e22ee1 113 6000 Bow Ninecandle 2006e22f0e 113 6023 Noel Boetie's new badge It appears that Noel was issued a replacement badge during the event. When first scanning Noel Boetie's badge his ID number was 6020. As noted previously, there is no need to scan all of the badges in the above table. If you happen to scan Noel Boetie's old badge and Shinny Upatree's badge it'd be clear that the most likely badge ID sequence is 6020 to 6025. Now that we have some badge ID values we can head back to the Workshop Room. Stand next to the HID lock, open the Proxmark CLI, and simulate a badge using its Wiegand value. For example, to simulate Sparkle Redberry's badge use lf hid sim -r 2006e22f0d . Alternatively, if you're extrapolating badge IDs based on collected information, you can use lf hid sim -w H10301 --fc 113 --cn 6024 to simulate Holly Evergreen's badge. Simply iterate over all badge IDs until the door unlocks. If you've already solved the 33.6kbps terminal hint then Fitzy Shortstack will have told you that Santa really seems to trust Shinny Upatree which confirms our solution. Shinny Upatree's badge is indeed the one that opens the door. Answer Use lf hid sim -r 2006e22f13 or lf hid sim -w H10301 --fc 113 --cn 6025 to unlock the door using Shinny Upatree's badge information. Being Santa Claus \u2693\ufe0e Walk to the end of the dark hallway. The two lights at the end are peephole cutouts for the eyes in the portrait hanging behind Santa in the Entryway. If you move forward towards the light you will end up in Santa's body. This is a direct reference to the movie Being John Malkovich and is explained in more detail in the Easter Egg section. It's also where the idea for this image came from. Santa what the hell is this I hear another Santa in my head You can now roam around as Santa and use the elevator to get to Santa's Office. This also unlocks a whole new set of narratives between Santa and the other NPCs, like the conference booths . Things are starting to make a little more sense now. It appears that Jack Frost has been impersonating Santa and causing all kinds of trouble!","title":"HID Lock"},{"location":"objectives/o5/#open-hid-lock","text":"Difficulty : Direct link : proxmark terminal Terminal hint : Speaker UNPrep and 33.6kbps","title":"Open HID Lock"},{"location":"objectives/o5/#objective","text":"Objective Open the HID lock in the Workshop. Talk to Bushy Evergreen near the talk tracks for hints on this challenge. You may also visit Fitzy Shortstack in the kitchen for tips. Bushy Evergreen Some people scan other people's badges and try those codes at locked doors. Other people scan one or two and just try to vary room numbers. Do whatever works best for you! Fitzy Shortstack You know, Santa really seems to trust Shinny Upatree...","title":"Objective"},{"location":"objectives/o5/#hints","text":"Reading Badges with Proxmark - Bushy Evergreen You can use a Proxmark to capture the facility code and ID value of HID ProxCard badge by running lf hid read when you are close enough to someone with a badge. Impersonating Badges with Proxmark - Bushy Evergreen You can also use a Proxmark to impersonate a badge to unlock a door, if the badge you impersonate has access. `lf hid sim -r 2006...... What's a Proxmark? - Bushy Evergreen The Proxmark is a multi-function RFID device, capable of capturing and replaying RFID events. Short List of Essential Proxmark Commands - Bushy Evergreen There's a short list of essential Proxmark commands also available. Proxmark Talk - Bushy Evergreen Larry Pesce knows a thing or two about HID attacks . He's the author of a course on wireless hacking!","title":"Hints"},{"location":"objectives/o5/#solution","text":"To solve this challenge we need to find a Proxmark device, roam around Santa's castle to scan NPC badges, and use the collected information to open the HID lock in the workshop. The Proxmark device can be found next to the table in the Wrapping Room and after picking it up you'll be able to access the Proxmark CLI via the item list on your conference badge. As per Bushy Evergreen's hint we can either go around scanning all the NPC badges or we can scan just a few and then fill in the blanks. As Larry Pesce mentions in his HID attacks HID cards are often sold with sequential ID numbers. So all we really need is just enough information to determine that sequence. To scan a badge, stand next to an NPC, open the Proxmark CLI and type lf search or lf hid read . If the NPC has a badge these commands will return the HID card information such as the facility code (FC), and the card ID. Walking around the castle we can compile the following list of badge IDs. NPC name Wiegand Facility code ID Sparkle Redberry 2006e22f0d 113 6022 Shinny Upatree 2006e22f13 113 6025 Holly Evergreen 2006e22f10 113 6024 Noel Boetie (old) 2006e22f08 113 6020 Noel Boetie (new) 2006e22ee1 113 6000 Bow Ninecandle 2006e22f0e 113 6023 Noel Boetie's new badge It appears that Noel was issued a replacement badge during the event. When first scanning Noel Boetie's badge his ID number was 6020. As noted previously, there is no need to scan all of the badges in the above table. If you happen to scan Noel Boetie's old badge and Shinny Upatree's badge it'd be clear that the most likely badge ID sequence is 6020 to 6025. Now that we have some badge ID values we can head back to the Workshop Room. Stand next to the HID lock, open the Proxmark CLI, and simulate a badge using its Wiegand value. For example, to simulate Sparkle Redberry's badge use lf hid sim -r 2006e22f0d . Alternatively, if you're extrapolating badge IDs based on collected information, you can use lf hid sim -w H10301 --fc 113 --cn 6024 to simulate Holly Evergreen's badge. Simply iterate over all badge IDs until the door unlocks. If you've already solved the 33.6kbps terminal hint then Fitzy Shortstack will have told you that Santa really seems to trust Shinny Upatree which confirms our solution. Shinny Upatree's badge is indeed the one that opens the door. Answer Use lf hid sim -r 2006e22f13 or lf hid sim -w H10301 --fc 113 --cn 6025 to unlock the door using Shinny Upatree's badge information.","title":"Solution"},{"location":"objectives/o5/#being-santa-claus","text":"Walk to the end of the dark hallway. The two lights at the end are peephole cutouts for the eyes in the portrait hanging behind Santa in the Entryway. If you move forward towards the light you will end up in Santa's body. This is a direct reference to the movie Being John Malkovich and is explained in more detail in the Easter Egg section. It's also where the idea for this image came from. Santa what the hell is this I hear another Santa in my head You can now roam around as Santa and use the elevator to get to Santa's Office. This also unlocks a whole new set of narratives between Santa and the other NPCs, like the conference booths . Things are starting to make a little more sense now. It appears that Jack Frost has been impersonating Santa and causing all kinds of trouble!","title":"Being Santa Claus"},{"location":"objectives/o6/","text":"Splunk Challenge \u2693\ufe0e Difficulty : Direct link : kringleconsoc website Terminal hint : Sort-o-Matic Objective \u2693\ufe0e Objective Access the Splunk terminal in the Great Room. What is the name of the adversary group that Santa feared would attack KringleCon? Angel Candysalt Hey Santa, there\u2019s some crazy stuff going on that we can see through our Splunk infrastructure. You better login and see what\u2019s up. Hints \u2693\ufe0e Adversary Emulation and Splunk - Minty Candycane Dave Herrald talks about emulating advanced adversaries and hunting them with Splunk . Splunk Basics - Minty Candycane There was a great Splunk talk at KringleCon 2 that's still available! Data Decoding and Investigation - Minty Candycane Defenders often need to manipulate data to decRypt, deCode, and refourm it into something that is useful. Cyber Chef is extremely useful here! Solution \u2693\ufe0e Alice Bluebird Ok elves! Like Santa said, I simulated a bunch of ATT&CK techniques/sub-techniques and stored the results from each run in its own dedicated set of Splunk indexes. Check out the Splunk Search Interface to get started answering Training Question 1. Training question 1 Question How many distinct MITRE ATT&CK techniques did Alice emulate? Alice Bluebird I stored every simulation in its own index so you can just use a Splunk search like | tstats count where index=* by index` for starters! I expect some of the elves in the SOC to confuse techniques with sub-techniques. Use the proposed | tstats count where index=* by index Splunk query and add query logic to grab the first 5 character from the index field and store it in a technique variable, remove any values which don't start with a 't', and finally drop any duplicates. The Statistics header will show the total result count. 1 2 3 4 | tstats count where index=* by index | eval technique=substr(index,0, 5) | search technique=t* | dedup technique Answer 13 Training question 2 Question What are the names of the two indexes that contain the results of emulating Enterprise ATT&CK technique 1059.003? (Put them in alphabetical order and separate them with a space) Alice Bluebird The search I used was: | tstats count where index=* by index | search index=T*-win OR T*-main | rex field=index \"(?<technique>t\\d+)[\\.\\-].0*\" | stats dc(technique) Training question 2 is almost too easy, especially if they use that search I just shared. I just really want those elves to understand what a Splunk index is, though. I'd expect them to Google it, but had to point a few of them to this definition . Similar to the previous question. Search for all index names beginning with t1059.003 and sort the results alphabetically. 1 2 3 | tstats count where index=* by index | search index=t1059.003* | sort index Answer t1059.003-main t1059.003-win Training question 3 Question One technique that Santa had us simulate deals with 'system information discovery'. What is the full name of the registry key that is queried to determine the MachineGuid? Alice Bluebird Now we can talk about some interesting stuff. What's actually in those emulation indexes! I'm assuming they watched the Splunk KringleCon talk and picked up on how to search MITRE's site, and that they should check out the atomics for that technique in the Atomic Red Team github repo. I want them to be comfortable searching in places like Atomic Red Team Answering this question doesn't require a Splunk query and is all about searching MITRE ATT&CK Techniques and Atomic Red Team Atomics resources. A seach for system information discovery on the MITRE ATT&CK website yields technique ID T1082. The atomics page for MITRE ATT&CK technique T1082 lists the registry key near the bottom of the page. Answer HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography Training question 4 Question According to events recorded by the Splunk Attack Range, when was the first OSTAP related atomic test executed? (Please provide the alphanumeric UTC timestamp.) Alice Bluebird Those folks over at Red Canary sure do like using OSTAP in their atomics, don't they? I suppose the SOC elves might overthink this one. Splunk Attack Range keeps track of the simulations that are run in index=attack You can then search that index for specific keywords... All we need to do is search for OSTAP across the whole attack index and sort the results by timestamp. 1 2 3 index=attack | search \"OSTAP\" | sort \"Execution Time _UTC\" Answer 2020-11-30T17:44:15Z Training question 5 Question One Atomic Red Team test executed by the Attack Range makes use of an open source package authored by frgnca on GitHub. According to Sysmon (Event Code 1) events in Splunk, what was the ProcessId associated with the first use of this component? Alice Bluebird Oh this was a fun one. It takes a bit of pivoting... Start by searching GitHub for frgnca which leads to the frgnca/AudioDeviceCmdlets repository. Next, search for AudioDeviceCmdlets in the Atomic Red Team repository which leads to T1123.md . Finally, search all Splunk indexes beginning with T1123 for process creation events (i.e., Sysmon Event ID 1 ) containing the string WindowsAudioDevice-Powershell-Cmdlet . The parent PowerShell process with PID 3648 matches the first use of the component. 1 2 3 index=T1123* | search EventCode=1 | search *WindowsAudioDevice-Powershell-Cmdlet* Answer 3648 Training question 6 Question Alice ran a simulation of an attacker abusing Windows registry run keys. This technique leveraged a multi-line batch file that was also used by a few other techniques. What is the final command of this multi-line batch file used as part of this simulation? T1547.001 contains information related to Registry Run Keys / Startup Folder . Search all indexes beginning with T1547.001 for process command lines matching *.bat* . One entry contains a PowerShell download of https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/ARTifacts/Misc/Discovery.bat . 1 2 3 index=T1547.001* | search CommandLine=*.bat* | sort _time Download Discovery.bat to find the final command. Answer quser Training question 7 Question According to x509 certificate events captured by Zeek (formerly Bro), what is the serial number of the TLS certificate assigned to the Windows domain controller in the attack range? Alice Bluebird I did not know if I should leave this one in here because it uses the old name for Zeek! In the meantime, I wanted them to look at something like index=* sourcetype=bro* and check out the SSL/TLS certs that are captured in the x509-related sourcetype. Execute the search query provided by Alice and use the fields to the left of the search results to filter on certificate.subject , which is the most likely certificate field to contain a full hostname. Select the entry matching the Windows Domain Controller (i.e. win-dc ) in the attack range (i.e., attackrange.local ). 1 2 index=* sourcetype=bro* \"certificate.subject\"=\"CN=win-dc-748.attackrange.local\" Expand any of the search results to find the certificate.serial field. Answer 55FCEEBB21270D9249E86F4B9DC7AA60 Challenge question Question What is the name of the adversary group that Santa feared would attack KringleCon? Alice Bluebird This last one is encrypted using your favorite phrase! The base64 encoded ciphertext is: 7FXjP1lyfKbyDK/MChyf36h7 It's encrypted with an old algorithm that uses a key. We don't care about RFC 7465 up here! I leave it to the elves to determine which one! Dave Herrald's Adversary Emulation and Automation talk hints at Santa's favorite phrase supposedly being Stay Frosty . Although, we now know that's most likely because Jack Frost has been walking around pretending to be Santa. RFC 7465 or Prohibiting RC4 Cipher Suites tells us which cipher was used to encrypt the information. Use Cyber Chef to decode the BASE64-encoded string (1) and run the output (2) through an RC4 recipe with Stay Frosty as the passphrase (3). Answer The Lollipop Guild","title":"Splunk"},{"location":"objectives/o6/#splunk-challenge","text":"Difficulty : Direct link : kringleconsoc website Terminal hint : Sort-o-Matic","title":"Splunk Challenge"},{"location":"objectives/o6/#objective","text":"Objective Access the Splunk terminal in the Great Room. What is the name of the adversary group that Santa feared would attack KringleCon? Angel Candysalt Hey Santa, there\u2019s some crazy stuff going on that we can see through our Splunk infrastructure. You better login and see what\u2019s up.","title":"Objective"},{"location":"objectives/o6/#hints","text":"Adversary Emulation and Splunk - Minty Candycane Dave Herrald talks about emulating advanced adversaries and hunting them with Splunk . Splunk Basics - Minty Candycane There was a great Splunk talk at KringleCon 2 that's still available! Data Decoding and Investigation - Minty Candycane Defenders often need to manipulate data to decRypt, deCode, and refourm it into something that is useful. Cyber Chef is extremely useful here!","title":"Hints"},{"location":"objectives/o6/#solution","text":"Alice Bluebird Ok elves! Like Santa said, I simulated a bunch of ATT&CK techniques/sub-techniques and stored the results from each run in its own dedicated set of Splunk indexes. Check out the Splunk Search Interface to get started answering Training Question 1.","title":"Solution"},{"location":"objectives/o7/","text":"Solve the Sleigh's CAN-D-BUS Problem \u2693\ufe0e Difficulty : Direct link : candbus website Terminal hint : CAN-Bus Investigation Objective \u2693\ufe0e Objective Jack Frost is somehow inserting malicious messages onto the sleigh's CAN-D bus. We need you to exclude the malicious messages and no others to fix the sleigh. Visit the NetWars room on the roof and talk to Wunorse Openslae for hints. Wunorse Openslae Say, do you have any thoughts on what might fix Santa's sleigh? Turns out: Santa's sleigh uses a variation of CAN bus that we call CAN-D bus. And there's something naughty going on in that CAN-D bus. The brakes seem to shudder when I put some pressure on them, and the doors are acting oddly. I'm pretty sure we need to filter out naughty CAN-D-ID codes. There might even be some valid IDs with invalid data bytes. Hints \u2693\ufe0e CAN ID Codes - Wunorse Openslae Try filtering out one CAN-ID at a time and create a table of what each might pertain to. What's up with the brakes and doors? Solution \u2693\ufe0e Solving this challenge requires a bit of trial and error. A good approach is to start with blocking everything, unblock one ID at a time, and see how each of the sleigh's controls influences the CAN-D bus ID codes and message values. Wunorse Openslae told us that The brakes seem to shudder when I put some pressure on them, and the doors are acting oddly. , so we probably want to focus on those parts in particular. By gradually testing each component you can build a table with CAN-D bus ID codes and message values. Sleigh control CAN-D bus ID Message value Start 02A 00FF00 Stop 02A 0000FF Lock 19B 000000000000 Unlock 19B 00000F000000 Steering 019 FFFFFFCD to 00000032 Brake 080 000000 to 000064 Accelerator 244 0000000000 to 0000002379 Unknwown 188 00000000 The Lock and Unlock buttons should generate 2 message values for ID 19B . However, when you filter out everything except for ID 19B you'll notice that out of nowhere additional 0000000F2057 message values appear on the CAN-D bus. We can't have anything happen with the sleigh doors at high altitudes so those need to be filtered out using 19B Equals 0000000F2057 . The second issue is that, when we pump the brakes, spurious negative message values appear on the CAN-D bus for ID 080 . Either you keep your foot off the brakes and the message value is 000000 or you press the brakes and the value gradually goes up to 000064 . Negative values don't make sense, so we filter those out by adding 080 Less 000000000000 . Once both exclusions are in place a Sleigh deFrosted! message appears, indicating success. Answer 19B Equals 0000000F2057 080 Less 000000000000","title":"CAN-D-BUS"},{"location":"objectives/o7/#solve-the-sleighs-can-d-bus-problem","text":"Difficulty : Direct link : candbus website Terminal hint : CAN-Bus Investigation","title":"Solve the Sleigh's CAN-D-BUS Problem"},{"location":"objectives/o7/#objective","text":"Objective Jack Frost is somehow inserting malicious messages onto the sleigh's CAN-D bus. We need you to exclude the malicious messages and no others to fix the sleigh. Visit the NetWars room on the roof and talk to Wunorse Openslae for hints. Wunorse Openslae Say, do you have any thoughts on what might fix Santa's sleigh? Turns out: Santa's sleigh uses a variation of CAN bus that we call CAN-D bus. And there's something naughty going on in that CAN-D bus. The brakes seem to shudder when I put some pressure on them, and the doors are acting oddly. I'm pretty sure we need to filter out naughty CAN-D-ID codes. There might even be some valid IDs with invalid data bytes.","title":"Objective"},{"location":"objectives/o7/#hints","text":"CAN ID Codes - Wunorse Openslae Try filtering out one CAN-ID at a time and create a table of what each might pertain to. What's up with the brakes and doors?","title":"Hints"},{"location":"objectives/o7/#solution","text":"Solving this challenge requires a bit of trial and error. A good approach is to start with blocking everything, unblock one ID at a time, and see how each of the sleigh's controls influences the CAN-D bus ID codes and message values. Wunorse Openslae told us that The brakes seem to shudder when I put some pressure on them, and the doors are acting oddly. , so we probably want to focus on those parts in particular. By gradually testing each component you can build a table with CAN-D bus ID codes and message values. Sleigh control CAN-D bus ID Message value Start 02A 00FF00 Stop 02A 0000FF Lock 19B 000000000000 Unlock 19B 00000F000000 Steering 019 FFFFFFCD to 00000032 Brake 080 000000 to 000064 Accelerator 244 0000000000 to 0000002379 Unknwown 188 00000000 The Lock and Unlock buttons should generate 2 message values for ID 19B . However, when you filter out everything except for ID 19B you'll notice that out of nowhere additional 0000000F2057 message values appear on the CAN-D bus. We can't have anything happen with the sleigh doors at high altitudes so those need to be filtered out using 19B Equals 0000000F2057 . The second issue is that, when we pump the brakes, spurious negative message values appear on the CAN-D bus for ID 080 . Either you keep your foot off the brakes and the message value is 000000 or you press the brakes and the value gradually goes up to 000064 . Negative values don't make sense, so we filter those out by adding 080 Less 000000000000 . Once both exclusions are in place a Sleigh deFrosted! message appears, indicating success. Answer 19B Equals 0000000F2057 080 Less 000000000000","title":"Solution"},{"location":"objectives/o8/","text":"Broken Tag Generator \u2693\ufe0e Difficulty : Direct link : tag-generator website Terminal hint : Redis Bug Hunt Objective \u2693\ufe0e Objective Help Noel Boetie fix the Tag Generator in the Wrapping Room. What value is in the environment variable GREETZ? Talk to Holly Evergreen in the kitchen for help with this. Noel Boetie Welcome to the Wrapping Room, Santa! The tag generator is acting up. I feel like the issue has something to do with weird files being uploaded. Can you help me figure out what's wrong? Hints \u2693\ufe0e Patience and Timing - Holly Evergreen Remember, the processing happens in the background so you might need to wait a bit after exploiting but before grabbing the output! Source Code Analysis - Holly Evergreen I'm sure there's a vulnerability in the source somewhere... surely Jack wouldn't leave their mark? Endpoint Exploration - Holly Evergreen Is there an endpoint that will print arbitrary files? Content-Type Gotcha - Holly Evergreen If you're having trouble seeing the code, watch out for the Content-Type! Your browser might be trying to help (badly)! Error Page Message Disclosure - Holly Evergreen Can you figure out the path to the script? It's probably on error pages! Download File Mechanism - Holly Evergreen Once you know the path to the file, we need a way to download it! Source Code Retrieval - Holly Evergreen We might be able to find the problem if we can get source code! Redirect to Download - Holly Evergreen If you find a way to execute code blindly, I bet you can redirect to a file then download that file! Solution \u2693\ufe0e Quick 'n dirty or reverse shell? You can either solve this with minimal effort or you can go for a reverse shell. We'll explore both options! Answer JackFrostWasHere Noel Boetie Yay! You found the flaw! We'll work on fixing it.","title":"Tag Generator"},{"location":"objectives/o8/#broken-tag-generator","text":"Difficulty : Direct link : tag-generator website Terminal hint : Redis Bug Hunt","title":"Broken Tag Generator"},{"location":"objectives/o8/#objective","text":"Objective Help Noel Boetie fix the Tag Generator in the Wrapping Room. What value is in the environment variable GREETZ? Talk to Holly Evergreen in the kitchen for help with this. Noel Boetie Welcome to the Wrapping Room, Santa! The tag generator is acting up. I feel like the issue has something to do with weird files being uploaded. Can you help me figure out what's wrong?","title":"Objective"},{"location":"objectives/o8/#hints","text":"Patience and Timing - Holly Evergreen Remember, the processing happens in the background so you might need to wait a bit after exploiting but before grabbing the output! Source Code Analysis - Holly Evergreen I'm sure there's a vulnerability in the source somewhere... surely Jack wouldn't leave their mark? Endpoint Exploration - Holly Evergreen Is there an endpoint that will print arbitrary files? Content-Type Gotcha - Holly Evergreen If you're having trouble seeing the code, watch out for the Content-Type! Your browser might be trying to help (badly)! Error Page Message Disclosure - Holly Evergreen Can you figure out the path to the script? It's probably on error pages! Download File Mechanism - Holly Evergreen Once you know the path to the file, we need a way to download it! Source Code Retrieval - Holly Evergreen We might be able to find the problem if we can get source code! Redirect to Download - Holly Evergreen If you find a way to execute code blindly, I bet you can redirect to a file then download that file!","title":"Hints"},{"location":"objectives/o8/#solution","text":"Quick 'n dirty or reverse shell? You can either solve this with minimal effort or you can go for a reverse shell. We'll explore both options! Answer JackFrostWasHere Noel Boetie Yay! You found the flaw! We'll work on fixing it.","title":"Solution"},{"location":"objectives/o9/","text":"ARP Shenanigans \u2693\ufe0e Difficulty : Direct link : santamode-arp terminal Terminal hint : Scapy Prepper Objective \u2693\ufe0e Objective Go to the NetWars room on the roof and help Alabaster Snowball get access back to a host using ARP. Retrieve the document at /NORTH_POLE_Land_Use_Board_Meeting_Minutes.txt . Who recused herself from the vote described on the document? Alabaster Snowball It seems that some interloper here at the North Pole has taken control of the host. We need to regain access to some important documents associated with Kringle Castle. Maybe we should try a machine-in-the-middle attack? That could give us access to manipulate DNS responses. But we'll still need to cook up something to change the HTTP response. I'm sure glad you're here Santa. Hints \u2693\ufe0e Sniffy - Alabaster Snowball Jack Frost must have gotten malware on our host at 10.6.6.35 because we can no longer access it. Try sniffing the eth0 interface using tcpdump -nni eth0 to see if you can view any traffic from that host. Embedy - Alabaster Snowball The malware on the host does an HTTP request for a .deb package. Maybe we can get command line access by sending it a command in a customized .deb file Resolvy - Alabaster Snowball Hmmm, looks like the host does a DNS request after you successfully do an ARP spoof. Let's return a DNS response resolving the request to our IP. Spoofy - Alabaster Snowball The host is performing an ARP request. Perhaps we could do a spoof to perform a machine-in-the-middle attack. I think we have some sample scapy traffic scripts that could help you in /home/guest/scripts . Solution \u2693\ufe0e Solution here... Answer Tanta Kringle","title":"ARP Shenanigans"},{"location":"objectives/o9/#arp-shenanigans","text":"Difficulty : Direct link : santamode-arp terminal Terminal hint : Scapy Prepper","title":"ARP Shenanigans"},{"location":"objectives/o9/#objective","text":"Objective Go to the NetWars room on the roof and help Alabaster Snowball get access back to a host using ARP. Retrieve the document at /NORTH_POLE_Land_Use_Board_Meeting_Minutes.txt . Who recused herself from the vote described on the document? Alabaster Snowball It seems that some interloper here at the North Pole has taken control of the host. We need to regain access to some important documents associated with Kringle Castle. Maybe we should try a machine-in-the-middle attack? That could give us access to manipulate DNS responses. But we'll still need to cook up something to change the HTTP response. I'm sure glad you're here Santa.","title":"Objective"},{"location":"objectives/o9/#hints","text":"Sniffy - Alabaster Snowball Jack Frost must have gotten malware on our host at 10.6.6.35 because we can no longer access it. Try sniffing the eth0 interface using tcpdump -nni eth0 to see if you can view any traffic from that host. Embedy - Alabaster Snowball The malware on the host does an HTTP request for a .deb package. Maybe we can get command line access by sending it a command in a customized .deb file Resolvy - Alabaster Snowball Hmmm, looks like the host does a DNS request after you successfully do an ARP spoof. Let's return a DNS response resolving the request to our IP. Spoofy - Alabaster Snowball The host is performing an ARP request. Perhaps we could do a spoof to perform a machine-in-the-middle attack. I think we have some sample scapy traffic scripts that could help you in /home/guest/scripts .","title":"Hints"},{"location":"objectives/o9/#solution","text":"Solution here... Answer Tanta Kringle","title":"Solution"}]}